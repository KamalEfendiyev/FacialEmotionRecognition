# Face Mesh-based Image Classification with InceptionResNetV2

## Описание

Этот проект использует технологии машинного обучения и обработки изображений для классификации изображений лиц с помощью модели InceptionResNetV2, дообученной на основе данных с использованием библиотеки MediaPipe для извлечения ключевых точек лица.

### Используемые технологии:
- **TensorFlow** и **Keras** для создания и обучения нейронной сети
- **MediaPipe** для обработки изображений и извлечения лицевых ключевых точек
- **OpenCV** для обработки изображений
- **InceptionResNetV2** как основа модели для классификации

## Структура проекта

- **train/** — Папка с обучающими изображениями.
- **validation/** — Папка с валидационными изображениями.
- **test/** — Папка с тестовыми изображениями.
- **main.py** — Основной скрипт для обучения модели.
- **requirements.txt** — Список зависимостей.

## Установка

### 1. Установка зависимостей

Для начала, установите все необходимые библиотеки:

```bash
pip install -r requirements.txt
```

### 2. Загрузка данных

Необходимо подготовить данные в формате изображений с метками для обучения. Структура данных должна быть следующей:

```
/train/
    /label1/
    /label2/
    ...
/validation/
    /label1/
    /label2/
    ...
/test/
    /label1/
    /label2/
    ...
```

где `label1`, `label2` и т. д. — это метки классов.

## Описание кода

1. **Загрузка и предобработка данных**  
   В этом проекте используется библиотека **MediaPipe** для извлечения ключевых точек лица с каждого изображения. После обработки изображения, данные масштабируются до размера 400x400 пикселей и нормализуются (поделены на 255).

2. **Разделение данных**  
   Данные разделяются на обучающие, тестовые и валидационные наборы. Затем метки классов кодируются с использованием one-hot encoding.

3. **Создание модели**  
   В качестве основы модели используется предобученная сеть **InceptionResNetV2**, дополненная несколькими слоями для классификации. Модель обучается на изображениях, с использованием категориальной кросс-энтропии в качестве функции потерь и Adam оптимизатора.

4. **Обучение**  
   Обучение происходит с использованием данных с увеличением изображений (data augmentation). Для предотвращения переобучения используются коллбеки, такие как уменьшение скорости обучения при остановке улучшений (`ReduceLROnPlateau`) и ранняя остановка (`EarlyStopping`).

5. **Оценка модели**  
   После завершения обучения, модель оценивается на тестовых данных и выводятся показатели потерь и точности.

## Пример вывода

После завершения обучения и тестирования, вы получите вывод в следующем формате:

```
Evaluation Loss: 0.4567, Evaluation Accuracy: 87.65
```

## Зависимости

Для работы проекта потребуются следующие библиотеки:

- `tensorflow`
- `keras`
- `opencv-python`
- `mediapipe`
- `matplotlib`
- `scikit-learn`

## Цель

Проект создан с целью изучения методов компьютерного зрения и машинного обучения в классификации изображений лиц. 
